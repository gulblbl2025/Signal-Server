version: 2.1

jobs:
  get-ip:
    docker:
      - image: cimg/base:stable
    parameters:
      region:
        type: string
      env:
        type: string
    steps:
      - setup_remote_docker  # 关键步骤，允许使用 Docker 命令
      - run:
          name: 打印参数
          command: |
            echo "Region: << parameters.region >>"
            echo "Env: << parameters.env >>"
            curl ifconfig.me
            docker pull nginx
            timeout 180s docker run nginx

workflows:
  version: 2
  matrix-workflow:
    jobs:
      - get-ip:
          matrix:
            parameters:
              # region: ["cn", "us", "eu", "hk", "ap", "jp"]
              region: ["cn"]
              env: ["prod", "test", "dev"]
